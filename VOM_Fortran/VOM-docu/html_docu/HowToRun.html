<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>HowToRun</title></head><body><p style="float:right; border-width:1px; border-style:solid"><object data="navi-bar.html" type="text/html"></object></p><h1>VOM - Model Description </h1><h2>VOM - info</h2><h3>VOM - how to run</h3><hr style="clear: right;"><hr><h2>Overview</h2><p>This is a short overview of how to run the model on differentsystems.Please consider the VOM - info, where the needed files and settings aredescribed. This describtion assumes that all these files are present.You have to compile the files and run the modelrepeatedly until the file "sce_status.txt" appears in the directory. Youhave three alternatives to do this.</p><hr><h3>Run the model manually</h3><p>First, the contents of VOM-code and VOM-input have to be copied into a directory of your choice.	Then you the model has to be compiled and started within this directory. 	As described in VOM - info, for finding the optimum parameter set, 	the model has to be restarted until the file "sce_status.txt" is written.To compile the model on a unix machine with the pgf90 compiler, type (replacethe pgf90 command with the appropriate command for your compiler, e.g.ifort for the Intel Fortran Compiler or gfortran for GNU Fortran):</p><pre>pgf90 -o model.x *.f90 </pre><p>This will create an executable file called "model.x". Now start the model by typing:</p><pre>./model.x</pre><p>The model was also tested on a Windows machine with the pgf90 compiler. Type:</p><pre>pgf90 -o model.exe *.f90 </pre><p>This will create an executable called "model.exe". Start the model by typing or double-click on:</p><pre>model.exe</pre><p>The model runs and starts to create and fill some files. One ist the"sce_progress.txt" file, which gets progressively filled with messages asthe model runs. To find out whether the model is still running, check ifthe "sce-progress.txt" is increasing or use the "ps" command. Ifthe model run has stopped and the "sce_status.txt" has not been written, the model has to be restarted again as described above. Every start of the executable addsanother loop to the file "sce_progress.txt" and a new set of parameters,until the optimal set has been found and the file "finalbest.txt" iswritten to the disc. If the file "sce_status.txt" appears, the model runs one more timeto write the results obtained with the optimised parameter set to the disc. This does not take long. Also see below.</p><hr><h3>Run the model automatically on a single computer</h3><p>There are 4 scripts available to compile and run the model automatically until the "finalbest.txt" is written:</p><ul>	<li>computer_start.script</li>	<li>computer_job.script</li>	<li>computer_vomrun.script</li>	<li>testrun.script</li></ul>If you execute testrun.script in its current directory (VOM_Fortran/VOM-scripts/single-computer/), a subdirectory called 'VOM_Fortran/testrun' will be created in VOM_Fortran, the necessary code files and example input data will be copied in that directory and the model will be run in optimisation mode until successful.<p>Inside the "computer_vomrun.script" the use of the gfortran compiler is specified. If you want to use another compiler you have to replace the gfortran command with the appropriate command for your compiler.</p><hr><h3>Run the model automatically on a cluster</h3><p>There are 3 scripts available to compile and run the model automatically on a cluster until the "finalbest.txt" is written:</p><ul>	<li>cluster_start.script</li>	<li>cluster_bsubjob.script</li>	<li>cluster_vomrun.script</li></ul>These scripts are adjusted to run the model on the cluster of the Max Planck Institute for Biogeochemistry.<br>Theprogram files have to be located in a directory that can be accessed bythe cluster. Only "cluster_start.script" has to be started after adjustingthe directory path in that script to the directory path that containsthe code and data. Best you place the script files inside the same folder as the other program files are. Also, you have to specify the host name inside the"cluster_bsubjob.script" and the path to the temporary folder on the cluster inside "cluster_vomrun.script". The scripts will make the model run repeatedly until"finalbest.txt" is written to the "results" subdirectory of thegiven directory. Now you have to run the model once again to createsome results (also see below) files by typing:<pre>./model.x</pre><p>Inside the "vom_cluster_run.script" the use of the pgf90 compiler is specified. If you want to use another compiler you have to replacethe pgf90 command with the appropriate command for your compiler.</p><hr><h3>Compute results</h3><p>You can run the model with a prescribed parameter set by supplying the parameter set in </p><h4>sce_lastbest.txt</h4><p>This file is created by the model if optimised values are found. You need to create an arbitrary file called 'sce_status.txt', containing the ascii letter '1' (i.e. the number 1) and run the model. You can also use values of pars.txt. Just add a space and 0 at the end of the file and rename it to 'sce_lastbest.txt'.</p><p>There are two more options to create result files.</p><h4>sce_bestpars.txt</h4><p>This file is created by the model runs after each loop and contains the currently best parameter set before the optimisation routine has converged. It has the same structure as sce_lastbest.txt.You can calculate the result files using sce_bestpars.txt by changing the line starting with 'vom_command' in vom_namelist to 'vom_command=2'  and starting the model once again.</p><h4>pars.txt</h4><p>You have to create this file on your own e.g. copying values out from sce_bestpars.txt. It has the same structure like sce_lastbest.txt but without the last value.If you want to use the finalbest.txt, delete the last value and rename the file to pars.txt. It can be used to calculate just the best ncp and writes this to one result file (model_output.txt).To do this you have to set the line starting with 'vom_command' in vom_namelist to 'vom_command=2' and start the model once again.</p><hr></body></html>